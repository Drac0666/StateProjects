Private Function GetLastFolderName(ByVal folderPath As String) As String
    Dim tempPath As String, pos As Long
    tempPath = Replace(folderPath, "/", "\") ' normalize
    ' Remove trailing backslash if exists
    If Right$(tempPath, 1) = "\" Then tempPath = Left$(tempPath, Len(tempPath) - 1)
    ' Find last backslash and extract after it
    pos = InStrRev(tempPath, "\")
    If pos > 0 Then
        GetLastFolderName = Mid$(tempPath, pos + 1)
    Else
        GetLastFolderName = tempPath
    End If
End Function
