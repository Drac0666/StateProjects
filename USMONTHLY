import pandas as pd

# Example DataFrame
data = {
    'ISIN': ['ISIN1', 'ISIN2', 'ISIN3', 'ISIN4', 'ISIN5'],
    'Par Value': [1.0, 1.2, 2.5, 3.0, 6.0],
    'Country': ['United Kingdom', 'United Kingdom', 'United States', 'Germany', 'Germany'],
    'Deal Type': ['RMBS', 'Consumer Loan', 'RMBS', 'RMBS', 'Consumer Loan']
}
df = pd.DataFrame(data)

# Define the bins for the Par Value column
bins = [0, 1.2, 2, 3, 5, float('inf')]

# Define the labels for the bins
labels = ['Less than 1.2', 'Exactly 1.2', 'Exactly 2', 'Exactly 3', 'Exactly 5', 'More than 5']

# Create a new column 'Par Value Bucket' containing the bucket labels
df['Par Value Bucket'] = pd.cut(df['Par Value'], bins=bins, labels=labels)

# Create an Excel writer object
with pd.ExcelWriter('output.xlsx') as writer:
    # Iterate over unique combinations of 'Country' and 'Deal Type'
    for (country, deal_type), group in df.groupby(['Country', 'Deal Type']):
        # Filter the DataFrame based on the combination of 'Country' and 'Deal Type'
        filtered_df = group.copy()
        
        # Write the filtered DataFrame to a worksheet named based on the combination of 'Country' and 'Deal Type'
        worksheet_name = f'{country} {deal_type}'
        filtered_df.to_excel(writer, sheet_name=worksheet_name, index=False)
