import os

def rename_files_with_incremental_ids(folder_path):
    # Create a dictionary to store the mapping between ConversationIDs and incremental numbers
    id_mapping = {}
    
    # List files in the folder
    files = os.listdir(folder_path)
    
    for file in files:
        if file.endswith(".msg"):  # Adjust the file extension as needed
            # Extract ConversationID from the file name
            conversation_id = file.split("_")[0]
            FileNameToKeep = file.split("_")[1:][0]
            
            # Check if the ConversationID is already in the mapping
            if conversation_id not in id_mapping:
                id_mapping[conversation_id] = len(id_mapping) + 1

            # Construct the new file name with an incremental number
            new_name = f"{id_mapping[conversation_id]}_{FileNameToKeep}"
            
            # Rename the file
            original_path = os.path.join(folder_path, file)
            new_path = os.path.join(folder_path, new_name)
            os.rename(original_path, new_path)
            print(f"Renamed: {file} -> {new_name}")

# Example usage:
folder_path = "/path/to/your/folder"
rename_files_with_incremental_ids(folder_path)
