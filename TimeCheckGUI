import win32gui
import win32con
import time

def switch_to_excel_with_title(title):
    # Find all open windows
    windows = []
    win32gui.EnumWindows(lambda hwnd, param: windows.append((hwnd, win32gui.GetWindowText(hwnd))), None)

    for hwnd, window_title in windows:
        if "Microsoft Excel" in window_title and title in window_title:
            win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)
            win32gui.SetForegroundWindow(hwnd)
            return True

    return False

# Example usage: Switch to Excel with a specific title
title_to_find = "Your Workbook - Microsoft Excel"
if switch_to_excel_with_title(title_to_find):
    print(f"Switched to Excel with title '{title_to_find}'")
else:
    print(f"No Excel window found with title '{title_to_find}'")
