import pandas as pd
import xlsxwriter

# ... (Your code for reading and preparing data)

# Export to Excel with enhanced formatting
writer = pd.ExcelWriter('maturity_analysis.xlsx', engine='xlsxwriter')
df_grouped.to_excel(writer, sheet_name='Analysis', index=True)  

# Access the workbook and worksheet objects
workbook = writer.book
worksheet = writer.sheets['Analysis']

# ------  Creative Header Formatting ------
header_format = workbook.add_format({
    'bold': True,
    'font_color': 'white',
    'bg_color': '#294F7D',    # Dark Blue
    'align': 'center',         # Center alignment
    'border': 1                # Add a subtle border
})

# Iterate over header names (as before) 
# ...  (Code to iterate over names remains the same)

# ------  Improved Number Formatting ------
number_format = workbook.add_format({
    'num_format': '#,##0_);[Red]_(#,##0)',  # Accounting style with red for negatives
    'align': 'right'                          # Right-align numbers
})

# ... (Code to apply number formatting remains the same)

writer.save()
