import pandas as pd
from scipy.optimize import fsolve

# Sample DataFrame with additional columns
data = {'A': [10, 20, 30, 40, 50], 'B': [5, 10, 15, 20, 25]}
df = pd.DataFrame(data)

# Function to calculate multiple columns based on 'W'
def calculate_final_rw(W, row):
    # Example calculation (replace with your actual calculation)
    A = row['A']
    B = row['B']
    Final_RW = W * A + B / 2 - 10  # Modify this calculation as needed
    return Final_RW

# Function to find the root (W) that results in Final RW of 20.01 for a given row
def find_w_for_row(row):
    def equation_to_solve(W):
        return calculate_final_rw(W, row) - 20.01
    initial_guess = 1  # Adjust initial guess if needed
    solution = fsolve(equation_to_solve, initial_guess)
    return solution[0]

# Apply the function to each row in the DataFrame
df['W'] = df.apply(find_w_for_row, axis=1)

print(df)
