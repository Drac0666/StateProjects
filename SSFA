import pandas as pd

# Sample data creation (replace this with your actual data loading step)
data = {
    'Final Asset Class': ['Class A', 'Class A', 'Class B', 'Class B', 'Class C'],
    'New W': [0.1, 0.2, 0.3, 0.4, 0.5],
    'ead_std': [100, 200, 150, 250, 300]
}
df = pd.DataFrame(data)

# Group by Final Asset Class
grouped = df.groupby('Final Asset Class')

# Calculate the weighted average New W for each asset class
weighted_avg_new_w = grouped.apply(lambda x: (x['New W'] * x['ead_std']).sum() / x['ead_std'].sum())

# Rename the resulting Series for better clarity
weighted_avg_new_w = weighted_avg_new_w.rename('Weighted Avg New W')

# Display the result
print(weighted_avg_new_w)
