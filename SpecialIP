import numpy as np

# Assuming `data` is a pandas DataFrame or Series
data_array = data.to_numpy()  # Convert to NumPy array for faster indexing
num_data_points = len(data_array)

# Preallocate results array for paths
path_results = np.zeros((2, paths))

# Generate all random indices for the loops in advance
monthly_random_indices = np.random.randint(0, num_data_points, (paths, 20))
annual_random_indices = np.random.randint(0, num_data_points, (paths, 231))  # 253 - 22 = 231

for i in range(paths):
    # Monthly Path Result
    monthly_rates = data_array[monthly_random_indices[i]]
    monthly_product = np.prod(monthly_rates)  # Product for the monthly period
    path_results[0, i] = monthly_product

    # Annual Path Result (continuing from monthly product)
    annual_rates = data_array[annual_random_indices[i]]
    annual_product = monthly_product * np.prod(annual_rates)  # Continue from monthly
    path_results[1, i] = annual_product
