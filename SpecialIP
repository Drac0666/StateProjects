import win32com.client
import pandas as pd

# Path to your MSG file
msg_path = r"C:\Your\Path\To\YourFile.msg"  # <-- update this path

# Open Outlook COM
outlook = win32com.client.Dispatch("Outlook.Application")
msg = outlook.CreateItemFromTemplate(msg_path)

# Extract subject (optional)
subject = msg.Subject
print("Subject:", subject)

# Extract HTML body
html_body = msg.HTMLBody

# Try to parse HTML tables with pandas
try:
    tables = pd.read_html(html_body)
    print(f"Found {len(tables)} tables")
    for i, table in enumerate(tables):
        print(f"\nTable {i+1}")
        print(table)
except Exception as e:
    print("Error parsing HTML tables:", e)
