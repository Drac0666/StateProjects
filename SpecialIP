import pandas as pd

# Sample data
data = {
    'Deal ID': ['A', 'A', 'A', 'B', 'B', 'C', 'C', 'C', 'C'],
    'DQ': [1, 0, 1, 1, 1, 0, 1, 0, 1]
}
df = pd.DataFrame(data)

# Group by 'Deal ID' and calculate the relative frequency of DQ == 1
result = df.groupby('Deal ID').apply(lambda x: (x['DQ'] == 1).sum() / len(x)).reset_index(name='Relative DQ Frequency')

print(result)
