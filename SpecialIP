# Load the saved models and encoder
model_sec1 = joblib.load('model_sec1.pkl')
model_sec2 = joblib.load('model_sec2.pkl')
model_sec3 = joblib.load('model_sec3.pkl')
encoder = joblib.load('onehot_encoder.pkl')

# Assume df_new is the new DataFrame with potential missing SEC values
df_new = pd.DataFrame()  # Replace with your actual DataFrame with missing SECs

# Use the encoder to transform new data's categorical columns
X_new_encoded = encoder.transform(df_new[['port_id', 'port_curr', 'investment_type']])

# Create DataFrame for the encoded features
X_new = pd.DataFrame(X_new_encoded)

# Predict missing SEC1 values
sec1_missing_idx = df_new['SEC1'].isnull()
if sec1_missing_idx.any():
    df_new.loc[sec1_missing_idx, 'SEC1'] = model_sec1.predict(X_new[sec1_missing_idx])

# Predict missing SEC2 values
sec2_missing_idx = df_new['SEC2'].isnull()
if sec2_missing_idx.any():
    df_new.loc[sec2_missing_idx, 'SEC2'] = model_sec2.predict(X_new[sec2_missing_idx])

# Predict missing SEC3 values
sec3_missing_idx = df_new['SEC3'].isnull()
if sec3_missing_idx.any():
    df_new.loc[sec3_missing_idx, 'SEC3'] = model_sec3.predict(X_new[sec3_missing_idx])

# Display the DataFrame with predicted SEC values
print(df_new)
