import os
import pandas as pd
import pyperclip  # To copy to clipboard

# Base directory to search
base_dir = r'C:\Your\Path\To\PostTrade\2024'  # Change this to your path!

# Create an empty list to store folders missing MCC.xlsx
missing_mcc_folders = []

# Walk through the directory
for dirpath, dirnames, filenames in os.walk(base_dir):
    # Check if 'MCC.xlsx' is in the current folder
    if 'MCC.xlsx' not in filenames:
        # Append the path if MCC.xlsx is missing
        missing_mcc_folders.append(dirpath)

# Convert the list into a DataFrame
df_missing = pd.DataFrame(missing_mcc_folders, columns=['Missing MCC Folder Path'])

# Copy the DataFrame to clipboard
df_missing.to_clipboard(index=False)

print("Done! Missing MCC.xlsx folder paths copied to clipboard.")
