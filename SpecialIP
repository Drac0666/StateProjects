import pandas as pd

# Example dataframe
data = {
    'UniqueKey': ['A', 'A', 'A', 'B', 'B', 'C'],
    'DQ': [10, 20, 30, 5, 15, 25],
    'TotalPar': [100, 100, 100, 200, 200, 300]
}
df = pd.DataFrame(data)

# Group by UniqueKey and calculate the required value
result = (
    df.groupby('UniqueKey')
    .apply(lambda x: x['DQ'].sum() / x['TotalPar'].iloc[0])  # Sum DQ and divide by TotalPar
    .reset_index(name='DQ_Sum_Per_TotalPar')
)

# Display result
print(result)
