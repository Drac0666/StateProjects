import pandas as pd

def split_tables_by_keyword(tables_dict):
    # Initialize empty lists to collect rows
    upgrade_rows = []
    downgrade_rows = []
    other_rows = []

    # Iterate over dictionary items
    for filename, df in tables_dict.items():
        # Iterate over dataframe rows
        for idx, row in df.iterrows():
            # Flag to check if found upgrade/downgrade
            found = False

            for value in row:
                # Check only for non-null values
                if pd.notnull(value):
                    value_str = str(value).strip()
                    if value_str == "Upgrade":
                        upgrade_rows.append(row.to_dict() | {'file': filename})
                        found = True
                        break
                    elif value_str == "Downgrade":
                        downgrade_rows.append(row.to_dict() | {'file': filename})
                        found = True
                        break

            if not found:
                other_rows.append(row.to_dict() | {'file': filename})

    # Create DataFrames from collected rows
    df_upgrade = pd.DataFrame(upgrade_rows)
    df_downgrade = pd.DataFrame(downgrade_rows)
    df_others = pd.DataFrame(other_rows)

    return df_upgrade, df_downgrade, df_others

df_upgrade, df_downgrade, df_others = split_tables_by_keyword(tables_dict)
