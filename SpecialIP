mt_only = issuer_detail[issuer_detail["MasterTrustExposure"] > 0]

mt_summary = (
    mt_only.groupby(subasset_col, dropna=False)
    .agg(
        **{
            "Count of Issuer": (issuer_col, "nunique"),
            "Max MT Exposure": ("MasterTrustExposure", "max"),
            "MT Breaches": ("MasterTrustBreach", "sum"),
            "Max MT Utilization": ("MasterTrustUtilization", "max"),
        }
    )
    .reset_index()
    .rename(columns={subasset_col: "Sub_Asset_Class"})
    .sort_values(
        ["Max MT Utilization", "Max MT Exposure"],
        ascending=[False, False],
        kind="stable"
    )
)
