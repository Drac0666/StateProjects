import pandas as pd

# Load your data
df = pd.read_excel('your_file.xlsx')  # or use pd.read_csv('your_file.csv')

# Columns to compare
rating_cols = ['RTG_SP', 'RTG_FITCH', 'RTG_DBRS', 'RTG_MOODYS']

# Function to find all column names with the minimum value
def get_min_sources(row):
    min_val = row[rating_cols].min(skipna=True)
    return ', '.join([col for col in rating_cols if row[col] == min_val])

# Apply the function row-wise
df['Lowest_Rating_Sources'] = df.apply(get_min_sources, axis=1)

# Optional: save result
df.to_excel('output_with_multiple_min_sources.xlsx', index=False)

print(df[['Lowest_Rating_Sources'] + rating_cols].head())
