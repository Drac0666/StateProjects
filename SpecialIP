import win32com.client

def send_calendar_invite():
    # Email details
    sender_email = "your_email@gmail.com"
    recipient_email = "maciej@gmail.com"
    subject = "ECB Rates"
    body = "Discussion on ECB Rates"

    # Calendar invite details
    start_date = "2025-02-12"
    start_time = "13:00"
    end_time = "14:00"

    # Create an Outlook application instance
    outlook = win32com.client.Dispatch("Outlook.Application")

    # Create a new meeting request
    appointment = outlook.CreateItem(1)  # 1 represents an AppointmentItem
    appointment.Start = f"{start_date} {start_time}"
    appointment.End = f"{start_date} {end_time}"
    appointment.Subject = subject
    appointment.Body = body
    appointment.Location = "Online"
    appointment.MeetingStatus = 1  # Sets the appointment as a meeting
    
    # Add recipient to the meeting
    appointment.Recipients.Add(recipient_email)

    # Send the invitation
    appointment.Send()
    print("Calendar invitation sent successfully!")

# Call the function
send_calendar_invite()
