import pandas as pd

# Load the Excel file
file_path = 'your_file.xlsx'  # Replace with your file path
df = pd.read_excel(file_path)

# Process the CUSIP column
df['CUSIP'] = df['CUSIP'].str.upper().apply(lambda x: x + " Mtge" if len(x) == 9 else x)

# Save or display the modified DataFrame as needed
df.to_excel('processed_file.xlsx', index=False)  # Save if needed
print(df)  # Or display the modified DataFrame


from openpyxl import load_workbook
import pandas as pd

# Load the Excel files
bulk_file_path = 'Bulk.xlsx'  # File to write into
data_file_path = 'your_data_file.xlsx'  # File containing the CUSIP data

# Read the CUSIP data using pandas
df = pd.read_excel(data_file_path)
df['CUSIP'] = df['CUSIP'].str.upper()  # Ensure all CUSIPs are uppercase

# Separate the CUSIPs based on conditions
cusips_len_12 = df[df['CUSIP'].str.len() == 12]['CUSIP'].tolist()
cusips_mtge = df[df['CUSIP'].str.endswith(" MTGE")]['CUSIP'].tolist()

# Load the bulk workbook and get the active sheet
wb = load_workbook(bulk_file_path)
ws = wb.active

# Write CUSIPs with length 12 starting from row 7 in column A
start_row = 7
for i, cusip in enumerate(cusips_len_12, start=start_row):
    ws[f'A{i}'] = cusip

# Find the last row from the previous operation
last_row = i + 1  # The row after the last written row in column A

# Write CUSIPs containing "Mtge" starting from last_row in column E
for j, cusip in enumerate(cusips_mtge, start=last_row):
    ws[f'E{j}'] = cusip

# Save the modified workbook
wb.save('Bulk_modified.xlsx')
print("CUSIP data has been written to Bulk_modified.xlsx.")
