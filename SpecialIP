# Define the quantiles for the right tail and their complements for the left tail
right_tail_quantiles = [0.95, 0.99, 0.995, 0.999, 0.9999]
left_tail_quantiles = [1 - q for q in right_tail_quantiles]

# Combine all quantiles
all_quantiles = sorted(right_tail_quantiles + left_tail_quantiles)

# Calculate quantiles for each currency column
quantile_values = sorted_results_df[currency_columns].quantile(all_quantiles, interpolation='nearest')

# Apply transformations: 1 - value for left tail, value - 1 for right tail
transformed_quantiles = quantile_values.apply(
    lambda value: 1 - value if value < 1 else value - 1
)

# Convert the results into a DataFrame
transformed_quantiles_df = transformed_quantiles.reset_index()
transformed_quantiles_df.columns = ['Quantile', 'Currency', 'Transformed Value']

# Rearrange into a pivot table for readability
pivot_df = transformed_quantiles_df.pivot(index='Quantile', columns='Currency', values='Transformed Value')

# Rename indices and columns for clarity
pivot_df.index.name = 'Quantile'
pivot_df.columns.name = 'Currency'

# Display the transformed quantiles DataFrame
pivot_df
