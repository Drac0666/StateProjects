import pandas as pd
import openpyxl
from openpyxl.styles import PatternFill

# Read clipboard data into a DataFrame
clipboard_data = pd.read_clipboard()

# Save DataFrame to an Excel file
clipboard_data.to_excel('AusRMBS.xlsx', index=False)

# Reopen the saved file with openpyxl
wb = openpyxl.load_workbook('AusRMBS.xlsx')
ws = wb.active

# Define the yellow fill color
yellow_fill = PatternFill(start_color="FFFF00", end_color="FFFF00", fill_type="solid")

# Iterate through rows and check for "SME Input" in any column except the first
for row in ws.iter_rows(min_row=2, max_row=ws.max_row):
    for cell in row[1:]:  # Skip the first column, start checking from the second column onwards
        if cell.value == "SME Input":
            row[0].fill = yellow_fill  # Color the first column cell in the same row

# Save the modified Excel file
wb.save('AusRMBS.xlsx')

print("File saved as AusRMBS.xlsx")
