

# Sort by 'Deal ID' and 'Current Balance (DQ == 1)' in descending order, then keep top 3 per 'Deal ID'
top_results_df = results_df.sort_values(['Deal ID', 'Current Balance (DQ == 1)'], ascending=[True, False])
top_results_df = top_results_df.groupby('Deal ID').head(3).reset_index(drop=True)


