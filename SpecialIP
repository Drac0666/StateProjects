import time
import win32com.client
import win32gui
import win32con
import win32api

def send_teams_message(chat_name, message):
    # Open Microsoft Teams (assuming itâ€™s already running)
    shell = win32com.client.Dispatch("WScript.Shell")
    shell.AppActivate("Microsoft Teams")
    time.sleep(1)

    # Find the chat by name and open it
    # This uses the TAB key to navigate, so the chat must be in the recent list or easy to access.
    shell.SendKeys("^+f")  # Ctrl + Shift + F for search
    time.sleep(0.5)
    shell.SendKeys(chat_name)  # Type the chat name
    time.sleep(1)
    shell.SendKeys("{ENTER}")  # Enter to open the chat
    time.sleep(1)

    # Send the message
    shell.SendKeys(message)
    time.sleep(0.5)
    shell.SendKeys("{ENTER}")  # Press Enter to send
    print("Message sent")

# Usage example
chat_name = "Your Chat or Channel Name"
message = "Hello from Python via win32api!"
send_teams_message(chat_name, message)
