import pandas as pd
import time
from datetime import datetime

# List of currencies
currencies = ["USD", "EUR", "GBP"]

# Dictionary to store start and end times
time_tracking = {}

# Loop through each currency
for currency in currencies:
    start_time = datetime.now()  # Record start time

    # Simulate some calculations
    time.sleep(2)

    end_time = datetime.now()  # Record end time

    # Store times in dictionary
    time_tracking[currency] = [start_time, end_time]

# Convert dictionary to DataFrame
time_df = pd.DataFrame(time_tracking, index=["Start Time", "End Time"])

# Simulated final results (with additional columns)
final_results = pd.DataFrame({
    "GBP": [175, 275, 375, 475, 575],
    "EUR": [150, 250, 350, 450, 550],
    "USD": [100, 200, 300, 400, 500],
    "Extra_Column_1": ["A", "B", "C", "D", "E"],  # Additional column
    "Extra_Column_2": [10, 20, 30, 40, 50],  # Another extra column
})

# Extract only currency columns from final_results
currency_columns = [col for col in final_results.columns if col in currencies]

# Reorder time_df to match the currency column order
time_df = time_df[currency_columns]

# Concatenate time_df and final_results, ensuring extra columns remain untouched
final_results = pd.concat([time_df, final_results], ignore_index=True)

# Display final DataFrame
import ace_tools as tools
tools.display_dataframe_to_user(name="Final Results", dataframe=final_results)
