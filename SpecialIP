import pandas as pd

# Assuming your filtered DataFrame is named df_filtered, with columns 'DQ' and 'Amortisation Value'
# Step 1: Group by 'Amortisation Value' and count occurrences of DQ = 1
amortisation_counts = df_filtered[df_filtered['DQ'] == 1].groupby('Amortisation Value').size().reset_index(name='Count')

# Step 2: Sort values to see which Amortisation Values have the most DQ=1 occurrences
amortisation_counts = amortisation_counts.sort_values(by='Count', ascending=False)

# Display the result
import ace_tools as tools; tools.display_dataframe_to_user(name="Amortisation Value Counts with DQ=1", dataframe=amortisation_counts)
