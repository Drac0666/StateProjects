import win32com.client

# Open Excel
excel = win32com.client.Dispatch("Excel.Application")
excel.Visible = True

# Open a workbook
workbook = excel.Workbooks.Open(r"C:\path\to\your\file.xlsx")

# Access sensitivity label
try:
    # Check if sensitivity label is available (Office 365 feature)
    sensitivity_label = workbook.SensitivityLabel

    # Set a new sensitivity label
    sensitivity_label.LabelId = "your-label-id"  # Purview classification ID
    sensitivity_label.LabelName = "Confidential"  # Example label name
    sensitivity_label.AssignmentMethod = 1  # Standard assignment method
    
    # Save changes
    workbook.Save()

    print("Sensitivity label applied successfully!")
except Exception as e:
    print("Failed to set sensitivity label:", e)
finally:
    # Clean up
    workbook.Close(SaveChanges=True)
    excel.Quit()
