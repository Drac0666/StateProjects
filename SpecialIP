import pandas as pd

# Define your desired column order (including missing ones)
column_order = [1, 2, 3, 4, 5, 6, 7]

# Define your desired row order
row_order = ['AAA', 'AA', 'A', 'BBB', 'BB', 'B', 'CCC', 'CC', 'C']

# Convert both columns to categorical with defined order
df['LowesRating'] = pd.Categorical(df['LowesRating'], categories=column_order, ordered=True)
df['AbecRating'] = pd.Categorical(df['AbecRating'], categories=row_order, ordered=True)

# (Optional) filter AssetClass
excluded_classes = ['Equity', 'Derivative']
filtered_df = df[~df['AssetClass'].isin(excluded_classes)]

# Create pivot table with totals
pivot = pd.pivot_table(
    filtered_df,
    values='ParValue',
    index='AbecRating',
    columns='LowesRating',
    aggfunc='sum',
    fill_value=0,
    margins=True,
    margins_name='Total'
)

print(pivot)
