import pandas as pd

# Read the Excel or CSV file
df = pd.read_excel('your_file.xlsx')  # or pd.read_csv('your_file.csv')

# Define the columns to compare
rating_cols = ['RTG_SP', 'RTG_FITCH', 'RTG_DBRS', 'RTG_MOODYS']

# Find the column with the minimum value for each row
df['Lowest_Rating_Source'] = df[rating_cols].idxmin(axis=1)

# Optional: Save the result
df.to_excel('output_with_lowest_rating.xlsx', index=False)

print(df[['Lowest_Rating_Source'] + rating_cols].head())
