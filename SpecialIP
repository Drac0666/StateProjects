# Group by DQ status and calculate mean values for selected columns
aggregates = tdf.groupby('DQ')[['Loan Amount', 'Property Value', 'Current Balance']].mean()

# Display the aggregates
print("Aggregated Data:")
print(aggregates)

# Visualize with box plots to show distributions of selected columns by DQ status
plt.figure(figsize=(12, 6))

# Loan Amount vs DQ
plt.subplot(1, 2, 1)
sns.boxplot(x='DQ', y='Loan Amount', data=tdf)
plt.title('Loan Amount by DQ Status')
plt.xlabel('DQ Status')
plt.ylabel('Loan Amount')

# Property Value vs DQ
plt.subplot(1, 2, 2)
sns.boxplot(x='DQ', y='Property Value', data=tdf)
plt.title('Property Value by DQ Status')
plt.xlabel('DQ Status')
plt.ylabel('Property Value')

plt.tight_layout()
plt.show()
