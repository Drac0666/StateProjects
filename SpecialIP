import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Load your data (replace 'your_data.csv' with actual file)
df = pd.read_csv('your_data.csv', parse_dates=['Date'], index_col='Date')

# Ensure data is sorted
df = df.sort_index()

# Calculate daily returns (assuming price data is provided)
df['Returns'] = df['Price'].pct_change()

# Compute rolling volatility (504-day standard deviation of returns)
df['Rolling_Volatility'] = df['Returns'].rolling(window=504).std()

# Identify the most volatile period
max_vol_date = df['Rolling_Volatility'].idxmax()
max_vol_value = df['Rolling_Volatility'].max()

print(f"Most volatile period ends on: {max_vol_date}, with volatility: {max_vol_value:.4f}")

# Plot the rolling volatility
plt.figure(figsize=(12, 6))
plt.plot(df.index, df['Rolling_Volatility'], label="504-day Rolling Volatility", color='b')
plt.axvline(max_vol_date, color='r', linestyle='--', label="Most Volatile Period")
plt.xlabel("Date")
plt.ylabel("Volatility")
plt.title("Rolling 504-Day Volatility")
plt.legend()
plt.show()
