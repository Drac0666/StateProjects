import os
import pandas as pd
import pyperclip  # To copy to clipboard

# Base directory to search
base_dir = r'C:\Your\Path\To\PostTrade\2024'  # Change this to your path!

# Create an empty list to store folders missing MCC.xlsx
missing_mcc_folders = []

# Loop through only the immediate subdirectories
for folder_name in os.listdir(base_dir):
    folder_path = os.path.join(base_dir, folder_name)
    
    # Check if it's a directory
    if os.path.isdir(folder_path):
        
        # Get the files in this folder (only top-level, not recursive)
        filenames = os.listdir(folder_path)
        
        # Check if any file contains 'MCC.xlsx'
        mcc_exists = any('MCC.xlsx' in filename for filename in filenames)
        
        if not mcc_exists:
            # Append the path if no MCC.xlsx variant is found
            missing_mcc_folders.append(folder_path)

# Convert the list into a DataFrame
df_missing = pd.DataFrame(missing_mcc_folders, columns=['Missing MCC Folder Path'])

# Copy the DataFrame to clipboard
df_missing.to_clipboard(index=False)

print("Done! Missing MCC.xlsx folder paths copied to clipboard.")
