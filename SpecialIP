import pandas as pd
import pyarrow as pa
import pyarrow.parquet as pq

# Example dictionary of DataFrames
dataframes = {
    "df1": pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}),
    "df2": pd.DataFrame({"x": [7, 8, 9], "y": [10, 11, 12]})
}

# Combine the DataFrames into a single DataFrame with a new column for the DataFrame name
combined_df = pd.concat(
    [df.assign(DataFrame_Name=name) for name, df in dataframes.items()]
)

# Convert the combined DataFrame to an Arrow Table
table = pa.Table.from_pandas(combined_df)

# Write the table to a Parquet file
pq.write_table(table, "dataframes.parquet")

# Read the table back from the Parquet file
read_table = pq.read_table("dataframes.parquet")

# Convert back to a pandas DataFrame
loaded_combined_df = read_table.to_pandas()

# Separate the DataFrames using the 'DataFrame_Name' column
loaded_dataframes = {
    name: group.drop(columns='DataFrame_Name').reset_index(drop=True)
    for name, group in loaded_combined_df.groupby('DataFrame_Name')
}

# Display loaded DataFrames to verify
for name, df in loaded_dataframes.items():
    print(f"{name}:\n{df}\n")


import pandas as pd

# Example dictionary of DataFrames
dataframes = {
    "df1": pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}),
    "df2": pd.DataFrame({"x": [7, 8, 9], "y": [10, 11, 12]})
}

# Save the dictionary of DataFrames to a single HDF5 file
with pd.HDFStore("dataframes.h5") as store:
    for name, df in dataframes.items():
        store.put(name, df)

# Load the dictionary of DataFrames from the HDF5 file
with pd.HDFStore("dataframes.h5") as store:
    loaded_dataframes = {name: store[name] for name in store.keys()}

# Display loaded DataFrames to verify
for name, df in loaded_dataframes.items():
    print(f"{name}:\n{df}\n")
