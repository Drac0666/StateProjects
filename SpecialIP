from sqlalchemy import create_engine
from sqlalchemy.exc import SQLAlchemyError

# Database connection details
db_host = "x.gan"
db_service_name = "TDR"
db_username = "your_username"  # Replace with your username
db_password = "your_password"  # Replace with your password

# Connection string for Oracle database using cx_Oracle connector
connection_string = (
    f"oracle+cx_oracle://{db_username}:{db_password}@"
    f"{db_host}/?service_name={db_service_name}"
)

try:
    # Create an SQLAlchemy engine
    engine = create_engine(connection_string)

    # Test the connection
    with engine.connect() as connection:
        print("Connected to Oracle database successfully.")

except SQLAlchemyError as e:
    print("Error while connecting to Oracle database:", e)
finally:
    if 'engine' in locals():
        engine.dispose()
        print("Connection closed.")
