import os
import pandas as pd
from openpyxl import load_workbook

def extract_data_from_excel(file_path):
    wb = load_workbook(filename=file_path, data_only=True)
    
    # Get the 'b' worksheet
    if "b" not in wb.sheetnames:
        print(f"Worksheet 'b' not found in file: {file_path}")
        return None
    
    ws_b = wb["b"]

    # Extract values
    try:
        date = ws_b["A1"].value
        clo = ws_b["B2"].value
        lf_clo = ws_b["B3"].value
        return {
            "Date": date,
            "CLO": clo,
            "LF CLO": lf_clo,
            "Filename": os.path.basename(file_path)
        }
    except Exception as e:
        print(f"Error reading file {file_path}: {e}")
        return None

def aggregate_data_from_folder(folder_path):
    data_list = []

    for filename in os.listdir(folder_path):
        if filename.endswith(".xlsx"):
            file_path = os.path.join(folder_path, filename)
            data = extract_data_from_excel(file_path)
            if data:
                data_list.append(data)
    
    return pd.DataFrame(data_list)

# Usage
folder_path = "/path/to/your/folder"
df = aggregate_data_from_folder(folder_path)

# Display or export
print(df)
# df.to_excel("aggregated_data.xlsx", index=False)
