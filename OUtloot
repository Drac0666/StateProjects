import win32com.client

def print_outlook_item_properties(item):
    """Prints all Outlook item properties.

    Args:
        item: The Outlook item to print the properties of.
    """

    for prop in item.GetProperties():
        print(f'{prop}: {item.GetInspector.GetActiveObject().GetProperty(prop)}')

if __name__ == '__main__':
    # Get the Outlook application object
    outlook = win32com.client.Dispatch('Outlook.Application')

    # Get the current Outlook item
    item = outlook.ActiveInspector.CurrentItem

    # Print the item properties
    print_outlook_item_properties(item)


import os
import win32com.client

Dim objItem As Object
Dim strLastVerbExecuted As String

Set objItem = Application.ActiveInspector.CurrentItem
strLastVerbExecuted = objItem.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x10810003")

If strLastVerbExecuted = 102 Then
    MsgBox "This is a reply."
Else
    MsgBox "This is not a reply."
End I



def is_response_to_email(msg_file_path):
    try:
        outlook = win32com.client.Dispatch("Outlook.Application")
        msg = outlook.Session.OpenSharedItem(msg_file_path)

        # Get the PR_MESSAGE_FLAGS property
        msg_flags = msg.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x0E070003")

        # Check if the MSG file is a response or reply
        if msg_flags & 0x01:  # Check if the MSG is a reply
            return True

    except Exception as e:
        print(f"Error: {e}")

    return False

# Example usage:
msg_file_path = "path_to_your_msg_file.msg"
is_response = is_response_to_email(msg_file_path)

if is_response:
    print("The MSG file is a response or reply to an email.")
else:
    print("The MSG file is not a response or reply to an email.")
