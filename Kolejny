import os
import subprocess
import tkinter as tk
from tkinter import filedialog

def find_msg_files(directory, msg_files=[]):
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith(".msg"):
                msg_files.append(os.path.join(root, file))
    return msg_files

def double_click_open(event):
    selected_item = listbox.get(listbox.curselection())
    subprocess.Popen(["start", "outlook", "/eml", selected_item[0]], shell=True)

# Create the main window
root = tk.Tk()
root.title("MSG File Viewer")

# Create a listbox for displaying the .msg files
listbox = tk.Listbox(root, selectmode=tk.SINGLE, width=50, height=15)
listbox.pack()

# Create a button to open a file dialog for choosing the root directory
def open_folder():
    directory = filedialog.askdirectory()
    msg_files = find_msg_files(directory)
    listbox.delete(0, tk.END)
    for msg_file in msg_files:
        listbox.insert(tk.END, msg_file)

open_button = tk.Button(root, text="Open Folder", command=open_folder)
open_button.pack()

# Bind the double click event to open the selected .msg file
listbox.bind("<Double-Button-1>", double_click_open)

root.mainloop()
